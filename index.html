<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<meta property='og:type' content='website'>
	<meta property='og:title' content='サイトタイトル'>
	<meta property='og:url' content='URL入れる'>
	<meta property='og:description' content='サイト説明'>
	<meta property="og:image" content="ogイメージのパス入れる">
	<meta name="description" content="サイト説明" />
	<title>kyonen-ya</title>
	<!-- CSSインポート -->
	<link href="common/reset.css" media="all" rel="stylesheet" type="text/css">
	<link href="./style.css" media="all" rel="stylesheet" type="text/css">
	<link rel="shortcut icon" href="img/favicon.ico"/>
	<!-- JavaScriptライブラリをCDNからインポート -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script><!-- jQuery -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script><!-- Moment.js -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/locale/ja.js"></script><!-- Moment.js 日本語ロケール -->
</head>

<body>
<div class="ly_centerWrapper"><!-- 大画面時の余白設定用 -->

<header class="ly_header">
	<div class="ly_header_inner">
		<h1 class="el_headerLogo"><a href="#">kyonen-ya</a></h1>
		<nav>
			<ul class="container">
				<li><a href="index.html">Home</a></li>
				<li><a href="works.html">Works</a></li>
				<li><a href="log.html">Blog</a></li>
				<li><a href="profile.html">Profile</a></li>
			</ul>
		</nav>
	</div>
	<!-- /.ly_header_inner -->
</header>

<main>

<section class="">
	<ul class="bl_posts" id="wrap"></ul>
	<article class="ly_cont">
		<div id="wrap_postpage"></div>
	</article>
<script type="text/javascript">
	// 変数宣言
	let h = "";
	// URLからクエリ文字列を取得する関数
	function getParam(name, url) {
		if (!url) url = window.location.href;
		name = name.replace(/[\[\]]/g, "\\$&");
		var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"), results = regex.exec(url);
		if (!results) return null;
		if (!results[2]) return '';
		return decodeURIComponent(results[2].replace(/\+/g, " "));
	}
	// ページidを取得、0以上の整数またはnull
	id = getParam('id');

/* --JSONデータ取得開始-- */
$(function(){ 
$.getJSON("manuscript.json", function(manuscripts){
	// 記事リスト（HTMLタグ生成関数）
	function htmlComb(id) {
		return `
	<li class="bl_posts_item">
	<a href="?id=${id}">
		<header class="bl_posts_header">
			<time class="bl_posts_date" datetime="${moment(manuscripts[id].date).format("YYYY-MM-DD HH:mm")}">
				${moment(manuscripts[id].date).format("YYYY-MM-DD")}
			</time>
		</header>
		<div class="bl_text">
			${manuscripts[id].text}
		</div>
		<footer class="bl_posts_footer">
			<span class="bl_posts_dateago">
				${moment(manuscripts[id].date).fromNow()}
			</span>
			<ul class="bl_posts_tags">
				<li><span>${manuscripts[id].tags}</span></li>
			<ul>
		</footer>
	</a>
	</li>
	`
	}
	// console.log(htmlComb(2));

	// 個別記事ページ（HTMLタグ生成関数）
	function htmlComb_page(id) {
		return '<article class="">'
		+ '<header>'
			+'<div class="post-info hp_textWeak upper">' 
			+ moment(manuscripts[id].date).format("YYYY-MM-DD HH:mm")
			+ '</div>'
			// + '<div class="el_heading3">' + manuscripts[i].title + '</div>'
		+ '</header>'
		+ '<div class="bl_text">'
			+ manuscripts[id].text
		+ '</div>'
		+ '<footer>'
			+ '<div class="post-info hp_textWeak lower">'
				+ moment(manuscripts[id].date).fromNow()
			+ '</div>'
			+ '<div class="post-info hp_textWeak lower tags">'
				+ manuscripts[id].tags
			+ '</div>' 
		+ '</footer>'
		+ '</article>'	
	}

	for(var i in manuscripts){
		// hashtags, 各タグに#をつける（この際どうでもいいか）
		/* let hashtags = "";
		for (let j = 0; j < manuscripts[i].tags.length; j++) { 
			hashtags += `#${manuscripts[i].tags[j]} `;
		} */	
		// text, 各長文の表示文字数を制限する
		/*let text = "";
		if (manuscripts[i].text.length > 140) {
			text = manuscripts[i].text.substr(0, 140) + '…' + '<p><div class="hp_textWeak">続きを読む</div></p>'; 
		} else {
			text = manuscripts[i].text;
		};*/
		// 記事一覧ページのHTMLタグを積算
		h += htmlComb(i);
	}
	
	if (id == null) {
		$("#wrap").append(h);
	} else {
		$("#wrap_postpage").append(htmlComb_page(id));
	};
// console.log(manuscripts[2].text.replace(/<("[^"]*"|'[^']*'|[^'">])*>/g,'')); //tagremove
}); 
	
});
</script>
</section>

<!-- ここから手動 -->
<section class="ly_cont">
	<div class="bl_text">
		<h2 class="el_heading2">このサイトについて</h2>
		<p>xxxのサイトです。xxをxxしています。</p>
		<h3 class="el_heading3">サイトマップ</h3>
		<ul>
			<li>Works：あいうえおかきくけこ</li>
			<li>Profile：たちつてとさしすせそ</li>
			<li>Blog：なにぬねのはひふへほ</li>
		</ul>
	</div>
	<!-- /bl_text -->
</section>

<section class="ly_cont">
	<div class="bl_text">
		<h2 class="el_heading2">著作解題</h2>
		<h3 class="el_heading3">セロ弾きのゴーシュ（19xx）</h3>
		<p>ゴーシュは町の活動写真館でセロを弾く係りでした。けれどもあんまり上手でないという評判でした。上手でないどころではなく実は仲間の楽手のなかではいちばん下手でしたから、いつでも楽長にいじめられるのでした。</p>
		<p>ひるすぎみんなは楽屋に円くならんで今度の町の音楽会へ出す第六交響曲の練習をしていました。</p>
	</div>
</section>

<section class="ly_cont">
	<article class="bl_text">
		<h2 class="el_heading2">お知らせ</h2>
		<h3 class="el_heading3">2010年1月6日(水)</h3>
			<p>ひるすぎみんなは楽屋に円くならんで今度の町の音楽会へ出す第六交響曲の練習をしていました。</p>
			<blockquote>
				<p>トランペットは一生けん命歌っています。</p>
				<p>ヴァイオリンも二いろ風のように鳴っています。</p>
				<p>クラリネットもボーボーとそれに手伝っています。</p>
			</blockquote>
			<p>ゴーシュも口をりんと結んで眼めを皿さらのようにして楽譜を見つめながらもう一心に弾いています。</p>
	</article>
	<!-- /bl_text -->

	<article class="bl_text">
		<h3 class="el_heading3">2010年1月6日(金)</h3>
			<p>にわかにぱたっと楽長が両手を鳴らしました。みんなぴたりと曲をやめてしんとしました。楽長がどなりました。</p>
			<p>「セロがおくれた。トォテテ　テテテイ、ここからやり直し。はいっ。」</p>
	</article>
	<!-- /bl_text -->
</section>

<section class="ly_cont">
<div class="bl_text">
	<h2 class="el_heading2">業績一覧</h2>
	<h3 class="el_heading3">論文</h3>
	<ol>
		<li>山田太郎, 「論文タイトル」, 『雑誌名』, 4巻, pp. 49-56, 〇〇学会, 2011. 3.<a class="btn" href="">［機関リポジトリ］</a></li>
		<li>山田太郎, 「論文タイトル：サブタイトル」, 『雑誌名』, 43-2号, pp. 81-94, 〇〇学会, 2010. 12.<a href="https://">［PDFリンク］</a></li>
	</ol>
	<h3 class="el_heading3">発表</h3>
	<ol>
		<li>山田太郎,「発表タイトル」, 〇〇セミナー, 〇〇大学, 2010. 3. 19. </li>
	</ol>
</div>
</section>

<section class="ly_cont">
	<h2 class="el_heading2">プロフィール</h2>
	<h3 class="el_heading3">京念屋 隆史（きょうねんや たかし）</h3>
	<div class="bl_horizTable">
		<table>
			<tbody>
				<tr>
					<th>名前</th>
					<td>山田 太郎</td>
				</tr>
				<tr>
					<th>所属</th>
					<td>〇〇大学〇〇研究科 〇〇課程</td>
				</tr>
				<tr>
					<th>学位</th>
					<td>〇〇（修士／〇〇大学）</td>
				</tr>
				<tr>
					<th>メール</th>
					<td>〇〇@gmail.com</td>
				</tr>				
			</tbody>
		</table>
	</div>
	<!-- /bl_horizTable -->	
</section>

</div><!-- /ly_centerWrapper -->
</main>

<footer class="ly_footer">
	<div class="ly_footer_inner">
		<p class="el_footerCopyright">&copy; 2020-<a href="#"> kyonen-ya</a> xxx</p>
	</div>
</footer>

</body>
</html>